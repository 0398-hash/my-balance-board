<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Balance Board</title>
    <style>
        body { margin: 0; font-family: sans-serif; background: linear-gradient(135deg, #e0f2fe 0%, #f3e8ff 50%, #fce7f3 100%); min-height: 100vh; padding: 15px; }
        .container { max-width: 600px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 20px; }
        .card { background: white; border-radius: 20px; padding: 25px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .label { font-size: 18px; font-weight: bold; color: #374151; margin-bottom: 15px; display: block; }
        input[type="date"], textarea { width: 100%; padding: 15px; font-size: 16px; border: 2px solid #e5e7eb; border-radius: 12px; box-sizing: border-box; }
        
        /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®è¦‹ãŸç›®ä¿®æ­£ */
        .slider-container { margin: 30px 0; }
        .slider { width: 100%; height: 12px; border-radius: 6px; outline: none; -webkit-appearance: none; background: #e5e7eb; border: 1px solid #d1d5db; }
        .slider::-webkit-slider-thumb { -webkit-appearance: none; width: 40px; height: 40px; background: white; border: 4px solid currentColor; border-radius: 50%; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.2); }
        .physical-slider { color: #34d399; }
        .mental-slider { color: #fca5a5; }

        .btn { width: 100%; padding: 20px; font-size: 18px; font-weight: bold; color: white; border: none; border-radius: 15px; cursor: pointer; margin-top: 10px; transition: transform 0.1s; }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: linear-gradient(135deg, #a78bfa 0%, #ec4899 100%); }
        .btn-copy { background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); margin-top: 20px; }
        
        canvas { width: 100% !important; height: auto !important; background: #f9fafb; border-radius: 12px; margin-top: 10px; }
        .record-item { background: #f9fafb; padding: 15px; margin: 10px 0; border-radius: 12px; border-left: 5px solid #a78bfa; }
        .hidden { display: none; }
        #notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 15px 30px; border-radius: 50px; font-weight: bold; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

<div id="notification" class="hidden">âœ“ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div>

<div class="container">
    <div class="header">
        <h1>My Balance Board</h1>
    </div>

    <div class="card">
        <label class="label">ğŸ“… æ—¥ä»˜</label>
        <input type="date" id="dateInput">

        <div class="slider-container">
            <label class="label">ğŸ§ ä½“ã®èª¿å­: <span id="pVal">5</span>/10</label>
            <input type="range" min="1" max="10" value="5" class="slider physical-slider" id="pSlider">
        </div>

        <div class="slider-container">
            <label class="label">ğŸ’— å¿ƒã®èª¿å­: <span id="mVal">5</span>/10</label>
            <input type="range" min="1" max="10" value="5" class="slider mental-slider" id="mSlider">
        </div>

        <label class="label">ğŸ“ ãƒ¡ãƒ¢</label>
        <textarea id="memoInput" placeholder="ä»Šã®æ°—æŒã¡ã‚’ãƒ¡ãƒ¢..."></textarea>

        <button class="btn btn-primary" onclick="save()">âœ“ è¨˜éŒ²ã™ã‚‹</button>
    </div>

    <div id="dataArea" class="hidden">
        <div class="card">
            <h2 class="label">ğŸ“Š éå»ã®æ¨ç§»</h2>
            <canvas id="myChart"></canvas>
            <button class="btn btn-copy" onclick="copyAnalysis()">ğŸ“‹ AIåˆ†æç”¨ã«è©³ç´°ã‚³ãƒ”ãƒ¼</button>
        </div>
        <div class="card">
            <h2 class="label">ğŸ“‹ è¨˜éŒ²ä¸€è¦§</h2>
            <div id="list"></div>
        </div>
    </div>
</div>

<script>
let records = JSON.parse(localStorage.getItem('balanceRecords') || '[]');

function save() {
    const data = {
        date: document.getElementById('dateInput').value,
        physical: parseInt(document.getElementById('pSlider').value),
        mental: parseInt(document.getElementById('mSlider').value),
        memo: document.getElementById('memoInput').value
    };
    records = records.filter(r => r.date !== data.date);
    records.push(data);
    records.sort((a, b) => new Date(a.date) - new Date(b.date));
    localStorage.setItem('balanceRecords', JSON.stringify(records));
    showNotif('è¨˜éŒ²ã—ã¾ã—ãŸï¼');
    render();
}

// ã¿ãã‚„ã•ã‚“ãŒå¸Œæœ›ã—ãŸã€Œè©³ç´°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
function copyAnalysis() {
    if (records.length === 0) return;
    
    const dataText = records.slice(-7).map(r => 
        `æ—¥ä»˜: ${r.date}\nä½“ã®èª¿å­: ${r.physical}/10\nå¿ƒã®èª¿å­: ${r.mental}/10\nãƒ¡ãƒ¢: ${r.memo || 'ãªã—'}`
    ).join('\n\n');

    const prompt = `ç§ã¯è‡ªåˆ†ã®çŠ¶æ…‹ã‚’èª¬æ˜ã™ã‚‹ã®ãŒè‹¦æ‰‹ã§ã™ã€‚ä»¥ä¸‹ã®è¨˜éŒ²ã‚’è©³ç´°ã«åˆ†æã—ã€2ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†ã‘ã¦å›ç­”ã—ã¦ãã ã•ã„ã€‚

ã€å›ç­”ã®æ§‹æˆã€‘

**ã‚»ã‚¯ã‚·ãƒ§ãƒ³1: ç§ã¸ã®å¯„ã‚Šæ·»ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**
å„ªã—ã„å£èª¿ã§ã€ç§ã«å‘ã‘ã¦ä»¥ä¸‹ã‚’ä¼ãˆã¦ãã ã•ã„ï¼š
- ã“ã®æœŸé–“ã®é ‘å¼µã‚Šã‚„å¤‰åŒ–ã¸ã®åŠ´ã„ã®è¨€è‘‰
- æ°—ã¥ã„ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„å‚¾å‘ã«ã¤ã„ã¦ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹
- ä»Šå¾Œæ°—ã‚’ã¤ã‘ã‚‹ã¨ã‚ˆã„ã“ã¨

**ã‚»ã‚¯ã‚·ãƒ§ãƒ³2: æ”¯æ´å“¡ã•ã‚“ã¸ã®å…±æœ‰ç”¨ï¼ˆå¿…ãšä»¥ä¸‹ã®å½¢å¼ã§ï¼‰**

â–¼ã“ã“ã‹ã‚‰ã‚³ãƒ”ãƒ¼â–¼

ã€ãƒãƒ©ãƒ³ã‚¹åˆ†æã€‘
ä½“ã¨å¿ƒã®æ•°å€¤ã®ä¹–é›¢ã€ãƒãƒ©ãƒ³ã‚¹ã®çŠ¶æ…‹ã«ã¤ã„ã¦

ã€å¤‰åŒ–ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘
æ•°å€¤ã®æ¨ç§»ã‹ã‚‰è¦‹ãˆã‚‹å‚¾å‘ã€æ³¢ã®ç‰¹å¾´

ã€æ³¨æ„ã™ã¹ãç‚¹ã€‘
ä»Šå¾Œã®ãƒªã‚¹ã‚¯ã‚„æ°—ã‚’ã¤ã‘ã‚‹ã¹ãã“ã¨

ã€æ”¯æ´å“¡ã•ã‚“ã¸ã€‘
é¢è«‡ã§ç¢ºèªã—ã¦ã»ã—ã„ãƒã‚¤ãƒ³ãƒˆã€ã‚µãƒãƒ¼ãƒˆã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹

â–²ã“ã“ã¾ã§ã‚³ãƒ”ãƒ¼â–²

ãƒ‡ãƒ¼ã‚¿ï¼š
${dataText}`;

    navigator.clipboard.writeText(prompt).then(() => showNotif('âœ“ è©³ç´°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ï¼'));
}

function render() {
    if (records.length > 0) document.getElementById('dataArea').classList.remove('hidden');
    const list = document.getElementById('list');
    list.innerHTML = records.slice().reverse().map(r => `
        <div class="record-item">
            <strong>${r.date}</strong> | ä½“:${r.physical} å¿ƒ:${r.mental}<br>
            <small>${r.memo}</small>
        </div>
    `).join('');
    drawChart();
}

function drawChart() {
    const canvas = document.getElementById('myChart');
    const ctx = canvas.getContext('2d');
    const last7 = records.slice(-7);
    canvas.width = canvas.offsetWidth;
    canvas.height = 200;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const step = canvas.width / 8;
    
    last7.forEach((r, i) => {
        const x = (i + 1) * step;
        // ä½“ã®æ£’ (ç·‘)
        ctx.fillStyle = '#86efac';
        ctx.fillRect(x - 10, 180, 8, -(r.physical * 15));
        // å¿ƒã®æ£’ (èµ¤)
        ctx.fillStyle = '#fca5a5';
        ctx.fillRect(x + 2, 180, 8, -(r.mental * 15));
        
        ctx.fillStyle = '#6b7280';
        ctx.font = '10px Arial';
        ctx.fillText(r.date.split('-')[2], x - 5, 195);
    });
}

function showNotif(msg) {
    const n = document.getElementById('notification');
    n.textContent = msg;
    n.classList.remove('hidden');
    setTimeout(() => n.classList.add('hidden'), 3000);
}

document.getElementById('pSlider').oninput = e => document.getElementById('pVal').textContent = e.target.value;
document.getElementById('mSlider').oninput = e => document.getElementById('mVal').textContent = e.target.value;
document.getElementById('dateInput').value = new Date().toISOString().split('T')[0];
render();
</script>
</body>
</html>